<input name="attr_version" type="hidden" value="3.3"/><input name="attr_latest_versioning_upgrade" type="hidden" value="1"/><rolltemplate class="sheet-rolltemplate-rolls"><div class="sheet-template-container"><!-- - Display a header on the template ---><div class="sheet-template-header"> <h1>{{#header}}{{header}}{{/header}}</h1></div><!-- - Display the dice roll in the template ---><div class="sheet-template-body">{{#dice}}<div class="sheet-template-roll"><span>{{dice}} </span></div>{{/dice}}
{{#description}}<div class="sheet-template-desc"><span>{{description}}</span></div>{{/description}}</div></div></rolltemplate><div class="dropzone compendium-drop-target creatures pregens"><input name="attr_drop_name" type="hidden" value="" accept="Name"/><input name="attr_drop_data" type="hidden" value="" accept="data"/><input name="attr_drop_content" type="hidden" value="" accept="Content"/><input name="attr_drop_category" type="hidden" value="" accept="Category"/><input class="type" name="attr_sheet_type" type="hidden" value="character"/><div class="grid gap-6"><h1 class="ellipse capitalize text-4xl font-weight-bold text-4xl--line-height brand-font-h1 text-center" data-i18n="Style Guide"></h1><div class="grid gap-4 grid-flow-column grid-cols-2 content-start"><div class="grid gap-2"><h2 class="ellipse capitalize text-2xl font-weight-medium text-2xl--line-height brand-font-h2 text-center" data-i18n="Headers"></h2><h1 class="ellipse capitalize text-4xl font-weight-bold text-4xl--line-height brand-font-h1" data-i18n="h1 header"></h1><h2 class="ellipse capitalize text-2xl font-weight-medium text-2xl--line-height brand-font-h2" data-i18n="h2 header"></h2><h3 class="ellipse capitalize text-lg font-weight-medium text-lg--line-height brand-font-h3" data-i18n="h3 header"></h3><h4 class="ellipse capitalize text-base font-weight-bold brand-font-h4" data-i18n="h4 header"></h4></div><div class="grid gap-2"><h2 class="ellipse capitalize text-2xl font-weight-medium text-2xl--line-height brand-font-h2 text-center" data-i18n="Inputs"></h2><div class="grid gap-2 grid-flow-col items-center col-auto-fr"><h3 class="ellipse capitalize text-lg font-weight-medium text-lg--line-height brand-font-h3 w-fit" data-i18n="text"></h3><input class="w-full bg-transparent border-x-transparent border-t-transparent border-b-neutral-900 border-b-2 rounded-none px-2.5 py-1 text-base transition-colors w-full bg-transparent border-x-transparent border-t-transparent border-b-neutral-900 border-b-2 rounded-none px-2.5 py-1 text-base transition-colors" type="text" name="attr_text" data-i18n-placeholder="text" value="" data-i18n="text"/></div><div class="grid gap-2 grid-flow-col items-center col-auto-fr"><h3 class="ellipse capitalize text-lg font-weight-medium text-lg--line-height brand-font-h3 w-fit" data-i18n="number"></h3><input class="w-full bg-transparent border-x-transparent border-t-transparent border-b-neutral-900 border-b-2 rounded-none px-2.5 py-1 text-base transition-colors w-full bg-transparent border-x-transparent border-t-transparent border-b-neutral-900 border-b-2 rounded-none px-2.5 py-1 text-base transition-colors" type="number" name="attr_number" data-i18n-placeholder="number" value="" data-i18n="number"/></div><div class="grid gap-2 grid-flow-col items-center col-auto-fr"><h3 class="ellipse capitalize text-lg font-weight-medium text-lg--line-height brand-font-h3 w-fit" data-i18n="checkbox"></h3><input class="w-full bg-transparent border-x-transparent border-t-transparent border-b-neutral-900 border-b-2 rounded-none px-2.5 py-1 text-base transition-colors w-full h-full min-w-6 min-h-6 border transition-colors rounded-sm flex items-center justify-center size-4" type="checkbox" name="attr_checkbox" data-i18n-placeholder="checkbox" value="" data-i18n="checkbox"/></div><div class="grid gap-2 grid-flow-col items-center col-auto-fr"><h3 class="ellipse capitalize text-lg font-weight-medium text-lg--line-height brand-font-h3 w-fit" data-i18n="radio"></h3><input class="w-full bg-transparent border-x-transparent border-t-transparent border-b-neutral-900 border-b-2 rounded-none px-2.5 py-1 text-base transition-colors w-full h-full min-w-6 min-h-6 border transition-colors rounded-sm flex items-center justify-center size-4" type="radio" name="attr_radio" data-i18n-placeholder="radio" value="" data-i18n="radio"/></div></div></div></div></div><div class="compendium_warning"><span data-i18n="accepting drop">ACCEPTING DROP FROM COMPENDIUM</span></div><div class="footer"><span>Version  </span><span name="attr_version"></span><span>Original template created by Emerald Productions, LLC</span><img src="https://raw.githubusercontent.com/clevett/roll20-SheetTemplate/master/src/imgs/EProd_Emerald_Gloss.png" alt="Emerald Productions logo of an E"/></div><script type="text/worker">const createAttributeName = (name: string) =>
  name?.replace(/ /g, "_").toLowerCase();
const findRepeatingFieldName = (trigger: string) => trigger.split("_")[1];
const getReprowAttributeName = (key: string) => {
  const reprowid = getReprowid(key);
  return key.split(`${reprowid}_`)[1];
};
const getReprowid = (trigger: string) => {
  const split = trigger.split("_");
  return `${split[0]}_${split[1]}_${split[2]}`;
};
const sumIntegers = (numbers: number[]) => numbers.reduce((a, b) => a + b, 0);
const versioningAttr = "latest_versioning_upgrade";

on("sheet:opened", () => {
  // setAttrs({ latest_versioning_upgrade: 3.2 }); //used for testing versioning
  getAttrs([versioningAttr], (v) => {
    versioning(parseFloat(v[versioningAttr]) || 1);
  });
});

const versionOneOne = () => {
  //placeholder for version 1.1
};

const versioning = async (version: number) => {
  const updateMessage = (v: number) =>
    console.log(
      `%c Sheet is updating to ${v}`,
      "color: orange; font-weight:bold"
    );

  switch (true) {
    case version < 1:
      versioning(1);
      updateMessage(1);
      break;
    case version < 1.1:
      updateMessage(1.1);
      versionOneOne();
      versioning(1.1);
      break;
    default:
      console.log(
        `%c Sheet is update to date.`,
        "color: green; font-weight:bold"
      );
      setAttrs({ version, [`${versioningAttr}`]: version });
  }
};
//Set variables, traits, and other attributes

// const attributes = [
//     "dexterity",
//     "strength",
//     "charisma",
// ]

// const characteristics = {
//  movement: ["strength", "dexterity"],
//  reflexes: ["dexterity"],
// };
//Calculate a simple derived attribute
// characteristics.movement.forEach((attr: string) => {
//   on(`change:${attr}`, () => {
//     getAttrs(characteristics.movement, (values) => {
//       const {strength, dexterity} = values;
//       setAttrs({
//         movement: sumIntegers([strength, dexterity]) / 2,
//       });
//     });
//   });
// });

//Calculate all the values of a repeating section. Useful for calculating weights, totals, etc.
// on(`change:repeating_events:weight`, ({ triggerName }) => {
//   const repeatingRow = getReprowid(triggerName);

//   getSectionIDs("events", (idArray) => {
//     let rows = [];
//     idArray.forEach((id) =>
//       rows.push(`repeating_events_${id}_weight`)
//     );

//     getAttrs(rows, (values) => {
//       const parsedNums = parseIntegers(values);
//       const weightValues = Object.values(parsedNums);
//       const sum = sumIntegers(weightValues);

//       setAttrs({
//         weight_total: sum,
//         [`${repeatingRow}_total_weight`]: sum,
//       });
//     });
//   });
// });
</script>